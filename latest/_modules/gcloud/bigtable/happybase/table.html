<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>gcloud.bigtable.happybase.table &mdash; gcloud 6fa89d8 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/css/main.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/normalize.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '6fa89d8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/js/vendor/modernizr-2.6.2.min.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="gcloud 6fa89d8 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body role="document">
    <header class="page-header fixed" role="banner">
      <h1 class="logo">
        <a href="index.html" title="back to home">
          <img src="../../../../_static/images/logo.svg" alt="Google Cloud Platform" />
          <span class="gcloud">gcloud</span>
        </a>
      </h1>
      <nav class="main-nav">
        <div class="nav-current">Python</div>
        <ul class="menu">
          <li>
            <a href="
https://googlecloudplatform.github.io/gcloud-java/" title="gcloud-java page">
              <img src="../../../../_static/images/icon-lang-java-duke.svg" alt="Duke icon" class="menu-icon" />
              Java
            </a>
          </li>
          <li>
            <a href="
https://googlecloudplatform.github.io/gcloud-node/#/docs" title="Node.js docs page">
              <img src="../../../../_static/images/icon-lang-nodejs.svg" alt="Node.js icon" class="menu-icon" />
              Node.js
            </a>
          </li>
          <li>
            <a href="#" title="Python docs page">
              <img src="../../../../_static/images/icon-lang-python.svg" alt="Python icon" class="menu-icon" />
              Python
            </a>
          </li>
          <li>
            <a href="
http://googlecloudplatform.github.io/gcloud-ruby/docs/latest" title="Ruby docs page">
              <img src="../../../../_static/images/icon-lang-ruby.svg" alt="Ruby icon" class="menu-icon" />
              Ruby
            </a>
          </li>
        </ul>
      </nav><!-- end of .main-nav -->
      <a href="https://github.com/GoogleCloudPlatform/gcloud-python/issues/new?title=%5BDocumentation+Issue%5D+&body=Page+Name%3A+_modules/gcloud/bigtable/happybase/table%0ARelease%3A%206fa89d8" target="_blank" class="v-btn" id="file-issue">
        <img src="_static/images/icon-link-github.svg" />
        Report an Issue
      </a>
    </header><!-- end of .page-header -->
    
      <article class="main lang-page" role="main">

      <header class="docs-header">
          <div class="versions">
            <a href="/gcloud-python/versions.html" class="v-btn">
              <img src="_static/images/icon-arrow-bullet.svg" />
              Version History (6fa89d8)
            </a>
          </div><!-- end of .versions -->
          <div>
            <a href="https://github.com/GoogleCloudPlatform/gcloud-python/issues/new?title=%5BDocumentation+Issue%5D+" target="_blank" class="v-btn" id="file-issue-secondary">
              <img src="_static/images/icon-link-github.svg" />
              Report an Issue
            </a>
          </div>
      </header>

      <section class="content">
        
  <h1>Source code for gcloud.bigtable.happybase.table</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2016 Google Inc. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;Google Cloud Bigtable HappyBase table module.&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">six</span>

<span class="kn">from</span> <span class="nn">gcloud._helpers</span> <span class="kn">import</span> <span class="n">_datetime_from_microseconds</span>
<span class="kn">from</span> <span class="nn">gcloud._helpers</span> <span class="kn">import</span> <span class="n">_microseconds_from_datetime</span>
<span class="kn">from</span> <span class="nn">gcloud._helpers</span> <span class="kn">import</span> <span class="n">_to_bytes</span>
<span class="kn">from</span> <span class="nn">gcloud._helpers</span> <span class="kn">import</span> <span class="n">_total_seconds</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.column_family</span> <span class="kn">import</span> <span class="n">GCRuleIntersection</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.column_family</span> <span class="kn">import</span> <span class="n">MaxAgeGCRule</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.column_family</span> <span class="kn">import</span> <span class="n">MaxVersionsGCRule</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.happybase.batch</span> <span class="kn">import</span> <span class="n">_get_column_pairs</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.happybase.batch</span> <span class="kn">import</span> <span class="n">_WAL_SENTINEL</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.happybase.batch</span> <span class="kn">import</span> <span class="n">Batch</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">CellsColumnLimitFilter</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">ColumnQualifierRegexFilter</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">FamilyNameRegexFilter</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">RowFilterChain</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">RowFilterUnion</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">RowKeyRegexFilter</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">TimestampRange</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.row_filters</span> <span class="kn">import</span> <span class="n">TimestampRangeFilter</span>
<span class="kn">from</span> <span class="nn">gcloud.bigtable.table</span> <span class="kn">import</span> <span class="n">Table</span> <span class="k">as</span> <span class="n">_LowLevelTable</span>


<span class="n">_WARN</span> <span class="o">=</span> <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span>
<span class="n">_UNPACK_I64</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">Struct</span><span class="p">(</span><span class="s1">&#39;&gt;q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unpack</span>
<span class="n">_SIMPLE_GC_RULES</span> <span class="o">=</span> <span class="p">(</span><span class="n">MaxAgeGCRule</span><span class="p">,</span> <span class="n">MaxVersionsGCRule</span><span class="p">)</span>


<div class="viewcode-block" id="make_row"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.make_row">[docs]</a><span class="k">def</span> <span class="nf">make_row</span><span class="p">(</span><span class="n">cell_map</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a row dict for a Thrift cell mapping.</span>

<span class="sd">    .. warning::</span>

<span class="sd">        This method is only provided for HappyBase compatibility, but does not</span>
<span class="sd">        actually work.</span>

<span class="sd">    :type cell_map: dict</span>
<span class="sd">    :param cell_map: Dictionary with ``fam:col`` strings as keys and ``TCell``</span>
<span class="sd">                     instances as values.</span>

<span class="sd">    :type include_timestamp: bool</span>
<span class="sd">    :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                              included with the output.</span>

<span class="sd">    :raises: :class:`NotImplementedError &lt;exceptions.NotImplementedError&gt;`</span>
<span class="sd">             always</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The Cloud Bigtable API output is not the same &#39;</span>
                              <span class="s1">&#39;as the output from the Thrift server, so this &#39;</span>
                              <span class="s1">&#39;helper can not be implemented.&#39;</span><span class="p">,</span> <span class="s1">&#39;Called with&#39;</span><span class="p">,</span>
                              <span class="n">cell_map</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_ordered_row"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.make_ordered_row">[docs]</a><span class="k">def</span> <span class="nf">make_ordered_row</span><span class="p">(</span><span class="n">sorted_columns</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a row dict for sorted Thrift column results from scans.</span>

<span class="sd">    .. warning::</span>

<span class="sd">        This method is only provided for HappyBase compatibility, but does not</span>
<span class="sd">        actually work.</span>

<span class="sd">    :type sorted_columns: list</span>
<span class="sd">    :param sorted_columns: List of ``TColumn`` instances from Thrift.</span>

<span class="sd">    :type include_timestamp: bool</span>
<span class="sd">    :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                              included with the output.</span>

<span class="sd">    :raises: :class:`NotImplementedError &lt;exceptions.NotImplementedError&gt;`</span>
<span class="sd">             always</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The Cloud Bigtable API output is not the same &#39;</span>
                              <span class="s1">&#39;as the output from the Thrift server, so this &#39;</span>
                              <span class="s1">&#39;helper can not be implemented.&#39;</span><span class="p">,</span> <span class="s1">&#39;Called with&#39;</span><span class="p">,</span>
                              <span class="n">sorted_columns</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table">[docs]</a><span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Representation of Cloud Bigtable table.</span>

<span class="sd">    Used for adding data and</span>

<span class="sd">    :type name: str</span>
<span class="sd">    :param name: The name of the table.</span>

<span class="sd">    :type connection: :class:`Connection &lt;.happybase.connection.Connection&gt;`</span>
<span class="sd">    :param connection: The connection which has access to the table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># This remains as legacy for HappyBase, but only the cluster</span>
        <span class="c1"># from the connection is needed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span> <span class="o">=</span> <span class="n">_LowLevelTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">_cluster</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;table.Table name=</span><span class="si">%r</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span>

<div class="viewcode-block" id="Table.families"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.families">[docs]</a>    <span class="k">def</span> <span class="nf">families</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the column families for this table.</span>

<span class="sd">        :rtype: dict</span>
<span class="sd">        :returns: Mapping from column family name to garbage collection rule</span>
<span class="sd">                  for a column family.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">column_family_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span><span class="o">.</span><span class="n">list_column_families</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col_fam</span><span class="p">,</span> <span class="n">col_fam_obj</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">column_family_map</span><span class="p">):</span>
            <span class="n">result</span><span class="p">[</span><span class="n">col_fam</span><span class="p">]</span> <span class="o">=</span> <span class="n">_gc_rule_to_dict</span><span class="p">(</span><span class="n">col_fam_obj</span><span class="o">.</span><span class="n">gc_rule</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Table.regions"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.regions">[docs]</a>    <span class="k">def</span> <span class="nf">regions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the regions for this table.</span>

<span class="sd">        .. warning::</span>

<span class="sd">            Cloud Bigtable does not give information about how a table is laid</span>
<span class="sd">            out in memory, so this method does not work. It is</span>
<span class="sd">            provided simply for compatibility.</span>

<span class="sd">        :raises: :class:`NotImplementedError &lt;exceptions.NotImplementedError&gt;`</span>
<span class="sd">                 always</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;The Cloud Bigtable API does not have a &#39;</span>
                                  <span class="s1">&#39;concept of splitting a table into regions.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.row"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.row">[docs]</a>    <span class="k">def</span> <span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve a single row of data.</span>

<span class="sd">        Returns the latest cells in each column (or all columns if ``columns``</span>
<span class="sd">        is not specified). If a ``timestamp`` is set, then **latest** becomes</span>
<span class="sd">        **latest** up until ``timestamp``.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: Row key for the row we are reading from.</span>

<span class="sd">        :type columns: list</span>
<span class="sd">        :param columns: (Optional) Iterable containing column names (as</span>
<span class="sd">                        strings). Each column name can be either</span>

<span class="sd">                          * an entire column family: ``fam`` or ``fam:``</span>
<span class="sd">                          * a single column: ``fam:col``</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch). If specified, only cells returned before the</span>
<span class="sd">                          the timestamp will be returned.</span>

<span class="sd">        :type include_timestamp: bool</span>
<span class="sd">        :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                                  included with the output.</span>

<span class="sd">        :rtype: dict</span>
<span class="sd">        :returns: Dictionary containing all the latest column values in</span>
<span class="sd">                  the row.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_columns_filter_helper</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
        <span class="c1"># versions == 1 since we only want the latest.</span>
        <span class="n">filter_</span> <span class="o">=</span> <span class="n">_filter_chain_helper</span><span class="p">(</span><span class="n">versions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span>
                                       <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>

        <span class="n">partial_row_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span><span class="o">.</span><span class="n">read_row</span><span class="p">(</span>
            <span class="n">row</span><span class="p">,</span> <span class="n">filter_</span><span class="o">=</span><span class="n">filter_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">partial_row_data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="n">_partial_row_to_dict</span><span class="p">(</span><span class="n">partial_row_data</span><span class="p">,</span>
                                    <span class="n">include_timestamp</span><span class="o">=</span><span class="n">include_timestamp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.rows"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.rows">[docs]</a>    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">include_timestamp</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve multiple rows of data.</span>

<span class="sd">        All optional arguments behave the same in this method as they do in</span>
<span class="sd">        :meth:`row`.</span>

<span class="sd">        :type rows: list</span>
<span class="sd">        :param rows: Iterable of the row keys for the rows we are reading from.</span>

<span class="sd">        :type columns: list</span>
<span class="sd">        :param columns: (Optional) Iterable containing column names (as</span>
<span class="sd">                        strings). Each column name can be either</span>

<span class="sd">                          * an entire column family: ``fam`` or ``fam:``</span>
<span class="sd">                          * a single column: ``fam:col``</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch). If specified, only cells returned before (or</span>
<span class="sd">                          at) the timestamp will be returned.</span>

<span class="sd">        :type include_timestamp: bool</span>
<span class="sd">        :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                                  included with the output.</span>

<span class="sd">        :rtype: list</span>
<span class="sd">        :returns: A list of pairs, where the first is the row key and the</span>
<span class="sd">                  second is a dictionary with the filtered values returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
            <span class="c1"># Avoid round-trip if the result is empty anyway</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_columns_filter_helper</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_row_keys_filter_helper</span><span class="p">(</span><span class="n">rows</span><span class="p">))</span>
        <span class="c1"># versions == 1 since we only want the latest.</span>
        <span class="n">filter_</span> <span class="o">=</span> <span class="n">_filter_chain_helper</span><span class="p">(</span><span class="n">versions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span>
                                       <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>

        <span class="n">partial_rows_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span><span class="o">.</span><span class="n">read_rows</span><span class="p">(</span><span class="n">filter_</span><span class="o">=</span><span class="n">filter_</span><span class="p">)</span>
        <span class="c1"># NOTE: We could use max_loops = 1000 or some similar value to ensure</span>
        <span class="c1">#       that the stream isn&#39;t open too long.</span>
        <span class="n">partial_rows_data</span><span class="o">.</span><span class="n">consume_all</span><span class="p">()</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row_key</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">partial_rows_data</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">curr_row_data</span> <span class="o">=</span> <span class="n">partial_rows_data</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">row_key</span><span class="p">]</span>
            <span class="n">curr_row_dict</span> <span class="o">=</span> <span class="n">_partial_row_to_dict</span><span class="p">(</span>
                <span class="n">curr_row_data</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="o">=</span><span class="n">include_timestamp</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">row_key</span><span class="p">,</span> <span class="n">curr_row_dict</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Table.cells"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.cells">[docs]</a>    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">versions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
              <span class="n">include_timestamp</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve multiple versions of a single cell from the table.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: Row key for the row we are reading from.</span>

<span class="sd">        :type column: str</span>
<span class="sd">        :param column: Column we are reading from; of the form ``fam:col``.</span>

<span class="sd">        :type versions: int</span>
<span class="sd">        :param versions: (Optional) The maximum number of cells to return. If</span>
<span class="sd">                         not set, returns all cells found.</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch). If specified, only cells returned before (or</span>
<span class="sd">                          at) the timestamp will be returned.</span>

<span class="sd">        :type include_timestamp: bool</span>
<span class="sd">        :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                                  included with the output.</span>

<span class="sd">        :rtype: list</span>
<span class="sd">        :returns: List of values in the cell (with timestamps if</span>
<span class="sd">                  ``include_timestamp`` is :data:`True`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_</span> <span class="o">=</span> <span class="n">_filter_chain_helper</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">versions</span><span class="o">=</span><span class="n">versions</span><span class="p">,</span>
                                       <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="n">partial_row_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span><span class="o">.</span><span class="n">read_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">filter_</span><span class="o">=</span><span class="n">filter_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">partial_row_data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cells</span> <span class="o">=</span> <span class="n">partial_row_data</span><span class="o">.</span><span class="n">_cells</span>
            <span class="c1"># We know that `_filter_chain_helper` has already verified that</span>
            <span class="c1"># column will split as such.</span>
            <span class="n">column_family_id</span><span class="p">,</span> <span class="n">column_qualifier</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="c1"># NOTE: We expect the only key in `cells` is `column_family_id`</span>
            <span class="c1">#       and the only key `cells[column_family_id]` is</span>
            <span class="c1">#       `column_qualifier`. But we don&#39;t check that this is true.</span>
            <span class="n">curr_cells</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">column_family_id</span><span class="p">][</span><span class="n">column_qualifier</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">_cells_to_pairs</span><span class="p">(</span>
                <span class="n">curr_cells</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="o">=</span><span class="n">include_timestamp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.scan"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.scan">[docs]</a>    <span class="k">def</span> <span class="nf">scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_start</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">row_stop</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">row_prefix</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">columns</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">include_timestamp</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a scanner for data in this table.</span>

<span class="sd">        This method returns a generator that can be used for looping over the</span>
<span class="sd">        matching rows.</span>

<span class="sd">        If ``row_prefix`` is specified, only rows with row keys matching the</span>
<span class="sd">        prefix will be returned. If given, ``row_start`` and ``row_stop``</span>
<span class="sd">        cannot be used.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Both ``row_start`` and ``row_stop`` can be :data:`None` to specify</span>
<span class="sd">            the start and the end of the table respectively. If both are</span>
<span class="sd">            omitted, a full table scan is done. Note that this usually results</span>
<span class="sd">            in severe performance problems.</span>

<span class="sd">        The keyword argument ``filter`` is also supported (beyond column and</span>
<span class="sd">        row range filters supported here). HappyBase / HBase users will have</span>
<span class="sd">        used this as an HBase filter string. (See the `Thrift docs`_ for more</span>
<span class="sd">        details on those filters.) However, Google Cloud Bigtable doesn&#39;t</span>
<span class="sd">        support those filter strings so a</span>
<span class="sd">        :class:`~gcloud.bigtable.row.RowFilter` should be used instead.</span>

<span class="sd">        .. _Thrift docs: http://hbase.apache.org/0.94/book/thrift.html</span>

<span class="sd">        The arguments ``batch_size``, ``scan_batching`` and ``sorted_columns``</span>
<span class="sd">        are allowed (as keyword arguments) for compatibility with</span>
<span class="sd">        HappyBase. However, they will not be used in any way, and will cause a</span>
<span class="sd">        warning if passed. (The ``batch_size`` determines the number of</span>
<span class="sd">        results to retrieve per request. The HBase scanner defaults to reading</span>
<span class="sd">        one record at a time, so this argument allows HappyBase to increase</span>
<span class="sd">        that number. However, the Cloud Bigtable API uses HTTP/2 streaming so</span>
<span class="sd">        there is no concept of a batched scan. The ``sorted_columns`` flag</span>
<span class="sd">        tells HBase to return columns in order, but Cloud Bigtable doesn&#39;t</span>
<span class="sd">        have this feature.)</span>

<span class="sd">        :type row_start: str</span>
<span class="sd">        :param row_start: (Optional) Row key where the scanner should start</span>
<span class="sd">                          (includes ``row_start``). If not specified, reads</span>
<span class="sd">                          from the first key. If the table does not contain</span>
<span class="sd">                          ``row_start``, it will start from the next key after</span>
<span class="sd">                          it that **is** contained in the table.</span>

<span class="sd">        :type row_stop: str</span>
<span class="sd">        :param row_stop: (Optional) Row key where the scanner should stop</span>
<span class="sd">                         (excludes ``row_stop``). If not specified, reads</span>
<span class="sd">                         until the last key. The table does not have to contain</span>
<span class="sd">                         ``row_stop``.</span>

<span class="sd">        :type row_prefix: str</span>
<span class="sd">        :param row_prefix: (Optional) Prefix to match row keys.</span>

<span class="sd">        :type columns: list</span>
<span class="sd">        :param columns: (Optional) Iterable containing column names (as</span>
<span class="sd">                        strings). Each column name can be either</span>

<span class="sd">                          * an entire column family: ``fam`` or ``fam:``</span>
<span class="sd">                          * a single column: ``fam:col``</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch). If specified, only cells returned before (or</span>
<span class="sd">                          at) the timestamp will be returned.</span>

<span class="sd">        :type include_timestamp: bool</span>
<span class="sd">        :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                                  included with the output.</span>

<span class="sd">        :type limit: int</span>
<span class="sd">        :param limit: (Optional) Maximum number of rows to return.</span>

<span class="sd">        :type kwargs: dict</span>
<span class="sd">        :param kwargs: Remaining keyword arguments. Provided for HappyBase</span>
<span class="sd">                       compatibility.</span>

<span class="sd">        :raises: If ``limit`` is set but non-positive, or if ``row_prefix`` is</span>
<span class="sd">                 used with row start/stop,</span>
<span class="sd">                 :class:`TypeError &lt;exceptions.TypeError&gt;` if a string</span>
<span class="sd">                 ``filter`` is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">legacy_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">kw_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="s1">&#39;scan_batching&#39;</span><span class="p">,</span> <span class="s1">&#39;sorted_columns&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kw_name</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">legacy_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kw_name</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">kw_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">legacy_args</span><span class="p">:</span>
            <span class="n">legacy_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">legacy_args</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;The HappyBase legacy arguments </span><span class="si">%s</span><span class="s1"> were used. These &#39;</span>
                       <span class="s1">&#39;arguments are unused by gcloud.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">legacy_args</span><span class="p">,))</span>
            <span class="n">_WARN</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Received unexpected arguments&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">limit</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;limit must be positive&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">row_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">row_stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;row_prefix cannot be combined with &#39;</span>
                                 <span class="s1">&#39;row_start or row_stop&#39;</span><span class="p">)</span>
            <span class="n">row_start</span> <span class="o">=</span> <span class="n">row_prefix</span>
            <span class="n">row_stop</span> <span class="o">=</span> <span class="n">_string_successor</span><span class="p">(</span><span class="n">row_prefix</span><span class="p">)</span>

        <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filter_</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Specifying filters as a string is not supported &#39;</span>
                            <span class="s1">&#39;by Cloud Bigtable. Use a &#39;</span>
                            <span class="s1">&#39;gcloud.bigtable.row.RowFilter instead.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filter_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filter_</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_columns_filter_helper</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
        <span class="c1"># versions == 1 since we only want the latest.</span>
        <span class="n">filter_chain</span> <span class="o">=</span> <span class="n">_filter_chain_helper</span><span class="p">(</span><span class="n">versions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span>
                                            <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>

        <span class="n">partial_rows_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span><span class="o">.</span><span class="n">read_rows</span><span class="p">(</span>
            <span class="n">start_key</span><span class="o">=</span><span class="n">row_start</span><span class="p">,</span> <span class="n">end_key</span><span class="o">=</span><span class="n">row_stop</span><span class="p">,</span>
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">filter_</span><span class="o">=</span><span class="n">filter_chain</span><span class="p">)</span>

        <span class="c1"># Mutable copy of data.</span>
        <span class="n">rows_dict</span> <span class="o">=</span> <span class="n">partial_rows_data</span><span class="o">.</span><span class="n">rows</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">partial_rows_data</span><span class="o">.</span><span class="n">consume_next</span><span class="p">()</span>
                <span class="n">row_key</span><span class="p">,</span> <span class="n">curr_row_data</span> <span class="o">=</span> <span class="n">rows_dict</span><span class="o">.</span><span class="n">popitem</span><span class="p">()</span>
                <span class="c1"># NOTE: We expect len(rows_dict) == 0, but don&#39;t check it.</span>
                <span class="n">curr_row_dict</span> <span class="o">=</span> <span class="n">_partial_row_to_dict</span><span class="p">(</span>
                    <span class="n">curr_row_data</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="o">=</span><span class="n">include_timestamp</span><span class="p">)</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">row_key</span><span class="p">,</span> <span class="n">curr_row_dict</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">break</span></div>

<div class="viewcode-block" id="Table.put"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.put">[docs]</a>    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wal</span><span class="o">=</span><span class="n">_WAL_SENTINEL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert data into a row in this table.</span>

<span class="sd">        .. note::</span>

<span class="sd">            This method will send a request with a single &quot;put&quot; mutation.</span>
<span class="sd">            In many situations, :meth:`batch` is a more appropriate</span>
<span class="sd">            method to manipulate data since it helps combine many mutations</span>
<span class="sd">            into a single request.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: The row key where the mutation will be &quot;put&quot;.</span>

<span class="sd">        :type data: dict</span>
<span class="sd">        :param data: Dictionary containing the data to be inserted. The keys</span>
<span class="sd">                     are columns names (of the form ``fam:col``) and the values</span>
<span class="sd">                     are strings (bytes) to be stored in those columns.</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch) that the mutation will be applied at.</span>

<span class="sd">        :type wal: object</span>
<span class="sd">        :param wal: Unused parameter (to be passed to a created batch).</span>
<span class="sd">                    Provided for compatibility with HappyBase, but irrelevant</span>
<span class="sd">                    for Cloud Bigtable since it does not have a Write Ahead</span>
<span class="sd">                    Log.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">wal</span><span class="o">=</span><span class="n">wal</span><span class="p">)</span> <span class="k">as</span> <span class="n">batch</span><span class="p">:</span>
            <span class="n">batch</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.delete"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wal</span><span class="o">=</span><span class="n">_WAL_SENTINEL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete data from a row in this table.</span>

<span class="sd">        This method deletes the entire ``row`` if ``columns`` is not</span>
<span class="sd">        specified.</span>

<span class="sd">        .. note::</span>

<span class="sd">            This method will send a request with a single delete mutation.</span>
<span class="sd">            In many situations, :meth:`batch` is a more appropriate</span>
<span class="sd">            method to manipulate data since it helps combine many mutations</span>
<span class="sd">            into a single request.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: The row key where the delete will occur.</span>

<span class="sd">        :type columns: list</span>
<span class="sd">        :param columns: (Optional) Iterable containing column names (as</span>
<span class="sd">                        strings). Each column name can be either</span>

<span class="sd">                          * an entire column family: ``fam`` or ``fam:``</span>
<span class="sd">                          * a single column: ``fam:col``</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch) that the mutation will be applied at.</span>

<span class="sd">        :type wal: object</span>
<span class="sd">        :param wal: Unused parameter (to be passed to a created batch).</span>
<span class="sd">                    Provided for compatibility with HappyBase, but irrelevant</span>
<span class="sd">                    for Cloud Bigtable since it does not have a Write Ahead</span>
<span class="sd">                    Log.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">wal</span><span class="o">=</span><span class="n">wal</span><span class="p">)</span> <span class="k">as</span> <span class="n">batch</span><span class="p">:</span>
            <span class="n">batch</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.batch"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.batch">[docs]</a>    <span class="k">def</span> <span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">transaction</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
              <span class="n">wal</span><span class="o">=</span><span class="n">_WAL_SENTINEL</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new batch operation for this table.</span>

<span class="sd">        This method returns a new</span>
<span class="sd">        :class:`Batch &lt;.happybase.batch.Batch&gt;` instance that can be</span>
<span class="sd">        used for mass data manipulation.</span>

<span class="sd">        :type timestamp: int</span>
<span class="sd">        :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                          epoch) that all mutations will be applied at.</span>

<span class="sd">        :type batch_size: int</span>
<span class="sd">        :param batch_size: (Optional) The maximum number of mutations to allow</span>
<span class="sd">                           to accumulate before committing them.</span>

<span class="sd">        :type transaction: bool</span>
<span class="sd">        :param transaction: Flag indicating if the mutations should be sent</span>
<span class="sd">                            transactionally or not. If ``transaction=True`` and</span>
<span class="sd">                            an error occurs while a</span>
<span class="sd">                            :class:`Batch &lt;.happybase.batch.Batch&gt;` is</span>
<span class="sd">                            active, then none of the accumulated mutations will</span>
<span class="sd">                            be committed. If ``batch_size`` is set, the</span>
<span class="sd">                            mutation can&#39;t be transactional.</span>

<span class="sd">        :type wal: object</span>
<span class="sd">        :param wal: Unused parameter (to be passed to the created batch).</span>
<span class="sd">                    Provided for compatibility with HappyBase, but irrelevant</span>
<span class="sd">                    for Cloud Bigtable since it does not have a Write Ahead</span>
<span class="sd">                    Log.</span>

<span class="sd">        :rtype: :class:`Batch &lt;gcloud.bigtable.happybase.batch.Batch&gt;`</span>
<span class="sd">        :returns: A batch bound to this table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                     <span class="n">transaction</span><span class="o">=</span><span class="n">transaction</span><span class="p">,</span> <span class="n">wal</span><span class="o">=</span><span class="n">wal</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.counter_get"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.counter_get">[docs]</a>    <span class="k">def</span> <span class="nf">counter_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the current value of a counter column.</span>

<span class="sd">        This method retrieves the current value of a counter column. If the</span>
<span class="sd">        counter column does not exist, this function initializes it to ``0``.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Application code should **never** store a counter value directly;</span>
<span class="sd">            use the atomic :meth:`counter_inc` and :meth:`counter_dec` methods</span>
<span class="sd">            for that.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: Row key for the row we are getting a counter from.</span>

<span class="sd">        :type column: str</span>
<span class="sd">        :param column: Column we are ``get``-ing from; of the form ``fam:col``.</span>

<span class="sd">        :rtype: int</span>
<span class="sd">        :returns: Counter value (after initializing / incrementing by 0).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Don&#39;t query directly, but increment with value=0 so that the counter</span>
        <span class="c1"># is correctly initialized if didn&#39;t exist yet.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter_inc</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.counter_set"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.counter_set">[docs]</a>    <span class="k">def</span> <span class="nf">counter_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a counter column to a specific value.</span>

<span class="sd">        This method is provided in HappyBase, but we do not provide it here</span>
<span class="sd">        because it defeats the purpose of using atomic increment and decrement</span>
<span class="sd">        of a counter.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: Row key for the row we are setting a counter in.</span>

<span class="sd">        :type column: str</span>
<span class="sd">        :param column: Column we are setting a value in; of</span>
<span class="sd">                       the form ``fam:col``.</span>

<span class="sd">        :type value: int</span>
<span class="sd">        :param value: Value to set the counter to.</span>

<span class="sd">        :raises: :class:`NotImplementedError &lt;exceptions.NotImplementedError&gt;`</span>
<span class="sd">                 always</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Table.counter_set will not be implemented. &#39;</span>
                                  <span class="s1">&#39;Instead use the increment/decrement &#39;</span>
                                  <span class="s1">&#39;methods along with counter_get.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Table.counter_inc"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.counter_inc">[docs]</a>    <span class="k">def</span> <span class="nf">counter_inc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Atomically increment a counter column.</span>

<span class="sd">        This method atomically increments a counter column in ``row``.</span>
<span class="sd">        If the counter column does not exist, it is automatically initialized</span>
<span class="sd">        to ``0`` before being incremented.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: Row key for the row we are incrementing a counter in.</span>

<span class="sd">        :type column: str</span>
<span class="sd">        :param column: Column we are incrementing a value in; of the</span>
<span class="sd">                       form ``fam:col``.</span>

<span class="sd">        :type value: int</span>
<span class="sd">        :param value: Amount to increment the counter by. (If negative,</span>
<span class="sd">                      this is equivalent to decrement.)</span>

<span class="sd">        :rtype: int</span>
<span class="sd">        :returns: Counter value after incrementing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low_level_table</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">binary_type</span><span class="p">):</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">column_family_id</span><span class="p">,</span> <span class="n">column_qualifier</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">increment_cell_value</span><span class="p">(</span><span class="n">column_family_id</span><span class="p">,</span> <span class="n">column_qualifier</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="c1"># See AppendRow.commit() will return a dictionary:</span>
        <span class="c1"># {</span>
        <span class="c1">#     u&#39;col-fam-id&#39;: {</span>
        <span class="c1">#         b&#39;col-name1&#39;: [</span>
        <span class="c1">#             (b&#39;cell-val&#39;, datetime.datetime(...)),</span>
        <span class="c1">#             ...</span>
        <span class="c1">#         ],</span>
        <span class="c1">#         ...</span>
        <span class="c1">#     },</span>
        <span class="c1"># }</span>
        <span class="n">modified_cells</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="c1"># Get the cells in the modified column,</span>
        <span class="n">column_cells</span> <span class="o">=</span> <span class="n">modified_cells</span><span class="p">[</span><span class="n">column_family_id</span><span class="p">][</span><span class="n">column_qualifier</span><span class="p">]</span>
        <span class="c1"># Make sure there is exactly one cell in the column.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_cells</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expected server to return one modified cell.&#39;</span><span class="p">)</span>
        <span class="n">column_cell</span> <span class="o">=</span> <span class="n">column_cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Get the bytes value from the column and convert it to an integer.</span>
        <span class="n">bytes_value</span> <span class="o">=</span> <span class="n">column_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">int_value</span><span class="p">,</span> <span class="o">=</span> <span class="n">_UNPACK_I64</span><span class="p">(</span><span class="n">bytes_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">int_value</span></div>

<div class="viewcode-block" id="Table.counter_dec"><a class="viewcode-back" href="../../../../happybase-table.html#gcloud.bigtable.happybase.table.Table.counter_dec">[docs]</a>    <span class="k">def</span> <span class="nf">counter_dec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Atomically decrement a counter column.</span>

<span class="sd">        This method atomically decrements a counter column in ``row``.</span>
<span class="sd">        If the counter column does not exist, it is automatically initialized</span>
<span class="sd">        to ``0`` before being decremented.</span>

<span class="sd">        :type row: str</span>
<span class="sd">        :param row: Row key for the row we are decrementing a counter in.</span>

<span class="sd">        :type column: str</span>
<span class="sd">        :param column: Column we are decrementing a value in; of the</span>
<span class="sd">                       form ``fam:col``.</span>

<span class="sd">        :type value: int</span>
<span class="sd">        :param value: Amount to decrement the counter by. (If negative,</span>
<span class="sd">                      this is equivalent to increment.)</span>

<span class="sd">        :rtype: int</span>
<span class="sd">        :returns: Counter value after decrementing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter_inc</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="o">-</span><span class="n">value</span><span class="p">)</span></div></div>


<span class="k">def</span> <span class="nf">_gc_rule_to_dict</span><span class="p">(</span><span class="n">gc_rule</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts garbage collection rule to dictionary if possible.</span>

<span class="sd">    This is in place to support dictionary values as was done</span>
<span class="sd">    in HappyBase, which has somewhat different garbage collection rule</span>
<span class="sd">    settings for column families.</span>

<span class="sd">    Only does this if the garbage collection rule is:</span>

<span class="sd">    * :class:`gcloud.bigtable.column_family.MaxAgeGCRule`</span>
<span class="sd">    * :class:`gcloud.bigtable.column_family.MaxVersionsGCRule`</span>
<span class="sd">    * Composite :class:`gcloud.bigtable.column_family.GCRuleIntersection`</span>
<span class="sd">      with two rules, one each of type</span>
<span class="sd">      :class:`gcloud.bigtable.column_family.MaxAgeGCRule` and</span>
<span class="sd">      :class:`gcloud.bigtable.column_family.MaxVersionsGCRule`</span>

<span class="sd">    Otherwise, just returns the input without change.</span>

<span class="sd">    :type gc_rule: :data:`NoneType &lt;types.NoneType&gt;`,</span>
<span class="sd">                   :class:`.GarbageCollectionRule`</span>
<span class="sd">    :param gc_rule: A garbage collection rule to convert to a dictionary</span>
<span class="sd">                    (if possible).</span>

<span class="sd">    :rtype: dict or</span>
<span class="sd">            :class:`gcloud.bigtable.column_family.GarbageCollectionRule`</span>
<span class="sd">    :returns: The converted garbage collection rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">gc_rule</span>
    <span class="k">if</span> <span class="n">gc_rule</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gc_rule</span><span class="p">,</span> <span class="n">MaxAgeGCRule</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time_to_live&#39;</span><span class="p">:</span> <span class="n">_total_seconds</span><span class="p">(</span><span class="n">gc_rule</span><span class="o">.</span><span class="n">max_age</span><span class="p">)}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gc_rule</span><span class="p">,</span> <span class="n">MaxVersionsGCRule</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;max_versions&#39;</span><span class="p">:</span> <span class="n">gc_rule</span><span class="o">.</span><span class="n">max_num_versions</span><span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gc_rule</span><span class="p">,</span> <span class="n">GCRuleIntersection</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gc_rule</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rule1</span><span class="p">,</span> <span class="n">rule2</span> <span class="o">=</span> <span class="n">gc_rule</span><span class="o">.</span><span class="n">rules</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">rule1</span><span class="p">,</span> <span class="n">_SIMPLE_GC_RULES</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule2</span><span class="p">,</span> <span class="n">_SIMPLE_GC_RULES</span><span class="p">)):</span>
                <span class="n">rule1</span> <span class="o">=</span> <span class="n">_gc_rule_to_dict</span><span class="p">(</span><span class="n">rule1</span><span class="p">)</span>
                <span class="n">rule2</span> <span class="o">=</span> <span class="n">_gc_rule_to_dict</span><span class="p">(</span><span class="n">rule2</span><span class="p">)</span>
                <span class="n">key1</span><span class="p">,</span> <span class="o">=</span> <span class="n">rule1</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="n">key2</span><span class="p">,</span> <span class="o">=</span> <span class="n">rule2</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key1</span> <span class="o">!=</span> <span class="n">key2</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="n">key1</span><span class="p">:</span> <span class="n">rule1</span><span class="p">[</span><span class="n">key1</span><span class="p">],</span> <span class="n">key2</span><span class="p">:</span> <span class="n">rule2</span><span class="p">[</span><span class="n">key2</span><span class="p">]}</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_next_char</span><span class="p">(</span><span class="n">str_val</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the next character based on a position in a string.</span>

<span class="sd">    :type str_val: str</span>
<span class="sd">    :param str_val: A string containing the character to update.</span>

<span class="sd">    :type index: int</span>
<span class="sd">    :param index: An integer index in ``str_val``.</span>

<span class="sd">    :rtype: str</span>
<span class="sd">    :returns: The next character after the character at ``index``</span>
<span class="sd">              in ``str_val``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ord_val</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">indexbytes</span><span class="p">(</span><span class="n">str_val</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_to_bytes</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">ord_val</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_string_successor</span><span class="p">(</span><span class="n">str_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Increment and truncate a byte string.</span>

<span class="sd">    Determines shortest string that sorts after the given string when</span>
<span class="sd">    compared using regular string comparison semantics.</span>

<span class="sd">    Modeled after implementation in ``gcloud-golang``.</span>

<span class="sd">    Increments the last byte that is smaller than ``0xFF``, and</span>
<span class="sd">    drops everything after it. If the string only contains ``0xFF`` bytes,</span>
<span class="sd">    ``&#39;&#39;`` is returned.</span>

<span class="sd">    :type str_val: str</span>
<span class="sd">    :param str_val: String to increment.</span>

<span class="sd">    :rtype: str</span>
<span class="sd">    :returns: The next string in lexical order after ``str_val``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">str_val</span> <span class="o">=</span> <span class="n">_to_bytes</span><span class="p">(</span><span class="n">str_val</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">str_val</span> <span class="o">==</span> <span class="n">b</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">str_val</span>

    <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_val</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">indexbytes</span><span class="p">(</span><span class="n">str_val</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="mh">0xff</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">index</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">b</span><span class="s1">&#39;&#39;</span>

    <span class="k">return</span> <span class="n">str_val</span><span class="p">[:</span><span class="n">index</span><span class="p">]</span> <span class="o">+</span> <span class="n">_next_char</span><span class="p">(</span><span class="n">str_val</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_convert_to_time_range</span><span class="p">(</span><span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a timestamp range from an HBase / HappyBase timestamp.</span>

<span class="sd">    HBase uses timestamp as an argument to specify an exclusive end</span>
<span class="sd">    deadline. Cloud Bigtable also uses exclusive end times, so</span>
<span class="sd">    the behavior matches.</span>

<span class="sd">    :type timestamp: int</span>
<span class="sd">    :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                      epoch). Intended to be used as the end of an HBase</span>
<span class="sd">                      time range, which is exclusive.</span>

<span class="sd">    :rtype: :class:`gcloud.bigtable.row.TimestampRange`,</span>
<span class="sd">            :data:`NoneType &lt;types.NoneType&gt;`</span>
<span class="sd">    :returns: The timestamp range corresponding to the passed in</span>
<span class="sd">              ``timestamp``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">timestamp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">next_timestamp</span> <span class="o">=</span> <span class="n">_datetime_from_microseconds</span><span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">timestamp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TimestampRange</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">next_timestamp</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_cells_to_pairs</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts list of cells to HappyBase format.</span>

<span class="sd">    For example::</span>

<span class="sd">      &gt;&gt;&gt; import datetime</span>
<span class="sd">      &gt;&gt;&gt; from gcloud.bigtable.row_data import Cell</span>
<span class="sd">      &gt;&gt;&gt; cell1 = Cell(b&#39;val1&#39;, datetime.datetime.utcnow())</span>
<span class="sd">      &gt;&gt;&gt; cell2 = Cell(b&#39;val2&#39;, datetime.datetime.utcnow())</span>
<span class="sd">      &gt;&gt;&gt; _cells_to_pairs([cell1, cell2])</span>
<span class="sd">      [b&#39;val1&#39;, b&#39;val2&#39;]</span>
<span class="sd">      &gt;&gt;&gt; _cells_to_pairs([cell1, cell2], include_timestamp=True)</span>
<span class="sd">      [(b&#39;val1&#39;, 1456361486255), (b&#39;val2&#39;, 1456361491927)]</span>

<span class="sd">    :type cells: list</span>
<span class="sd">    :param cells: List of :class:`gcloud.bigtable.row_data.Cell` returned</span>
<span class="sd">                  from a read request.</span>

<span class="sd">    :type include_timestamp: bool</span>
<span class="sd">    :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                              included with the output.</span>

<span class="sd">    :rtype: list</span>
<span class="sd">    :returns: List of values in the cell. If ``include_timestamp=True``, each</span>
<span class="sd">              value will be a pair, with the first part the bytes value in</span>
<span class="sd">              the cell and the second part the number of milliseconds in the</span>
<span class="sd">              timestamp on the cell.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">include_timestamp</span><span class="p">:</span>
            <span class="n">ts_millis</span> <span class="o">=</span> <span class="n">_microseconds_from_datetime</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">//</span> <span class="mi">1000</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ts_millis</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_partial_row_to_dict</span><span class="p">(</span><span class="n">partial_row_data</span><span class="p">,</span> <span class="n">include_timestamp</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a low-level row data object to a dictionary.</span>

<span class="sd">    Assumes only the latest value in each row is needed. This assumption</span>
<span class="sd">    is due to the fact that this method is used by callers which use</span>
<span class="sd">    a ``CellsColumnLimitFilter(1)`` filter.</span>

<span class="sd">    For example::</span>

<span class="sd">      &gt;&gt;&gt; import datetime</span>
<span class="sd">      &gt;&gt;&gt; from gcloud.bigtable.row_data import Cell, PartialRowData</span>
<span class="sd">      &gt;&gt;&gt; cell1 = Cell(b&#39;val1&#39;, datetime.datetime.utcnow())</span>
<span class="sd">      &gt;&gt;&gt; cell2 = Cell(b&#39;val2&#39;, datetime.datetime.utcnow())</span>
<span class="sd">      &gt;&gt;&gt; row_data = PartialRowData(b&#39;row-key&#39;)</span>
<span class="sd">      &gt;&gt;&gt; _partial_row_to_dict(row_data)</span>
<span class="sd">      {}</span>
<span class="sd">      &gt;&gt;&gt; row_data._cells[u&#39;fam1&#39;] = {b&#39;col1&#39;: [cell1], b&#39;col2&#39;: [cell2]}</span>
<span class="sd">      &gt;&gt;&gt; _partial_row_to_dict(row_data)</span>
<span class="sd">      {b&#39;fam1:col2&#39;: b&#39;val2&#39;, b&#39;fam1:col1&#39;: b&#39;val1&#39;}</span>
<span class="sd">      &gt;&gt;&gt; _partial_row_to_dict(row_data, include_timestamp=True)</span>
<span class="sd">      {b&#39;fam1:col2&#39;: (b&#39;val2&#39;, 1456361724480),</span>
<span class="sd">       b&#39;fam1:col1&#39;: (b&#39;val1&#39;, 1456361721135)}</span>

<span class="sd">    :type partial_row_data: :class:`.row_data.PartialRowData`</span>
<span class="sd">    :param partial_row_data: Row data consumed from a stream.</span>

<span class="sd">    :type include_timestamp: bool</span>
<span class="sd">    :param include_timestamp: Flag to indicate if cell timestamps should be</span>
<span class="sd">                              included with the output.</span>

<span class="sd">    :rtype: dict</span>
<span class="sd">    :returns: The row data converted to a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">cells</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">partial_row_data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()):</span>
        <span class="n">cell_vals</span> <span class="o">=</span> <span class="n">_cells_to_pairs</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span>
                                    <span class="n">include_timestamp</span><span class="o">=</span><span class="n">include_timestamp</span><span class="p">)</span>
        <span class="c1"># NOTE: We assume there is exactly 1 version since we used that in</span>
        <span class="c1">#       our filter, but we don&#39;t check this.</span>
        <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_filter_chain_helper</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">versions</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create filter chain to limit a results set.</span>

<span class="sd">    :type column: str</span>
<span class="sd">    :param column: (Optional) The column (``fam:col``) to be selected</span>
<span class="sd">                   with the filter.</span>

<span class="sd">    :type versions: int</span>
<span class="sd">    :param versions: (Optional) The maximum number of cells to return.</span>

<span class="sd">    :type timestamp: int</span>
<span class="sd">    :param timestamp: (Optional) Timestamp (in milliseconds since the</span>
<span class="sd">                      epoch). If specified, only cells returned before (or</span>
<span class="sd">                      at) the timestamp will be matched.</span>

<span class="sd">    :type filters: list</span>
<span class="sd">    :param filters: (Optional) List of existing filters to be extended.</span>

<span class="sd">    :rtype: :class:`RowFilter &lt;gcloud.bigtable.row.RowFilter&gt;`</span>
<span class="sd">    :returns: The chained filter created, or just a single filter if only</span>
<span class="sd">              one was needed.</span>
<span class="sd">    :raises: :class:`ValueError &lt;exceptions.ValueError&gt;` if there are no</span>
<span class="sd">             filters to chain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">binary_type</span><span class="p">):</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">column_family_id</span><span class="p">,</span> <span class="n">column_qualifier</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">fam_filter</span> <span class="o">=</span> <span class="n">FamilyNameRegexFilter</span><span class="p">(</span><span class="n">column_family_id</span><span class="p">)</span>
        <span class="n">qual_filter</span> <span class="o">=</span> <span class="n">ColumnQualifierRegexFilter</span><span class="p">(</span><span class="n">column_qualifier</span><span class="p">)</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">fam_filter</span><span class="p">,</span> <span class="n">qual_filter</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">versions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CellsColumnLimitFilter</span><span class="p">(</span><span class="n">versions</span><span class="p">))</span>
    <span class="n">time_range</span> <span class="o">=</span> <span class="n">_convert_to_time_range</span><span class="p">(</span><span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">time_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TimestampRangeFilter</span><span class="p">(</span><span class="n">time_range</span><span class="p">))</span>

    <span class="n">num_filters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_filters</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must have at least one filter.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">num_filters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">filters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RowFilterChain</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_columns_filter_helper</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a union filter for a list of columns.</span>

<span class="sd">    :type columns: list</span>
<span class="sd">    :param columns: Iterable containing column names (as strings). Each column</span>
<span class="sd">                    name can be either</span>

<span class="sd">                      * an entire column family: ``fam`` or ``fam:``</span>
<span class="sd">                      * a single column: ``fam:col``</span>

<span class="sd">    :rtype: :class:`RowFilter &lt;gcloud.bigtable.row.RowFilter&gt;`</span>
<span class="sd">    :returns: The union filter created containing all of the matched columns.</span>
<span class="sd">    :raises: :class:`ValueError &lt;exceptions.ValueError&gt;` if there are no</span>
<span class="sd">             filters to union.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column_family_id</span><span class="p">,</span> <span class="n">column_qualifier</span> <span class="ow">in</span> <span class="n">_get_column_pairs</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">fam_filter</span> <span class="o">=</span> <span class="n">FamilyNameRegexFilter</span><span class="p">(</span><span class="n">column_family_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">column_qualifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">qual_filter</span> <span class="o">=</span> <span class="n">ColumnQualifierRegexFilter</span><span class="p">(</span><span class="n">column_qualifier</span><span class="p">)</span>
            <span class="n">combined_filter</span> <span class="o">=</span> <span class="n">RowFilterChain</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="n">fam_filter</span><span class="p">,</span> <span class="n">qual_filter</span><span class="p">])</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combined_filter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fam_filter</span><span class="p">)</span>

    <span class="n">num_filters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_filters</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must have at least one filter.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">num_filters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">filters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RowFilterUnion</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_row_keys_filter_helper</span><span class="p">(</span><span class="n">row_keys</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a union filter for a list of rows.</span>

<span class="sd">    :type row_keys: list</span>
<span class="sd">    :param row_keys: Iterable containing row keys (as strings).</span>

<span class="sd">    :rtype: :class:`RowFilter &lt;gcloud.bigtable.row.RowFilter&gt;`</span>
<span class="sd">    :returns: The union filter created containing all of the row keys.</span>
<span class="sd">    :raises: :class:`ValueError &lt;exceptions.ValueError&gt;` if there are no</span>
<span class="sd">             filters to union.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row_key</span> <span class="ow">in</span> <span class="n">row_keys</span><span class="p">:</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RowKeyRegexFilter</span><span class="p">(</span><span class="n">row_key</span><span class="p">))</span>

    <span class="n">num_filters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_filters</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Must have at least one filter.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">num_filters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">filters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RowFilterUnion</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
</pre></div>

      </section><!-- end of .content -->
      <nav class="side-nav">
        <p class="caption"><span class="caption-text">gcloud</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../gcloud-api.html">Shared Core Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gcloud-auth.html">Authentication</a></li>
</ul>
<p class="caption"><span class="caption-text">Datastore</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-entities.html">Entities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-keys.html">Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-queries.html">Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-transactions.html">Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-batches.html">Batches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../datastore-helpers.html">Helpers</a></li>
</ul>
<p class="caption"><span class="caption-text">Storage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../storage-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../storage-blobs.html">Blobs / Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../storage-buckets.html">Buckets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../storage-acl.html">ACL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../storage-batch.html">Batches</a></li>
</ul>
<p class="caption"><span class="caption-text">Pub/Sub</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../pubsub-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pubsub-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pubsub-topic.html">Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pubsub-subscription.html">Subscriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pubsub-message.html">Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pubsub-iam.html">IAM Policy</a></li>
</ul>
<p class="caption"><span class="caption-text">BigQuery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigquery-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigquery-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigquery-dataset.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigquery-job.html">Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigquery-table.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigquery-query.html">Query</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Bigtable</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../happybase-package.html">HappyBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-client-intro.html">Base for Everything</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-cluster-api.html">Cluster Admin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-table-api.html">Table Admin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-data-api.html">Data API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-cluster.html">Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-table.html">Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-column-family.html">Column Families</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-row.html">Bigtable Row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-row-filters.html">Bigtable Row Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bigtable-row-data.html">Row Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../happybase-connection.html">HappyBase Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../happybase-pool.html">HappyBase Connection Pool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../happybase-table.html">HappyBase Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../happybase-batch.html">HappyBase Batch</a></li>
</ul>
<p class="caption"><span class="caption-text">Resource Manager</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../resource-manager-api.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../resource-manager-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../resource-manager-project.html">Projects</a></li>
</ul>
<p class="caption"><span class="caption-text">DNS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../dns-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dns-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dns-zone.html">Managed Zones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dns-resource-record-set.html">Resource Record Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dns-changes.html">Change Sets</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Logging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../logging-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../logging-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../logging-logger.html">Logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../logging-entries.html">Entries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../logging-metric.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../logging-sink.html">Sinks</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Monitoring</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-metric.html">Metric Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-resource.html">Monitored Resource Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-query.html">Time Series Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-timeseries.html">Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../monitoring-label.html">Label Descriptors</a></li>
</ul>
<p class="caption"><span class="caption-text">Translate</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../translate-usage.html">Using the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../translate-client.html">Client</a></li>
</ul>
<p class="caption"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GoogleCloudPlatform/gcloud-python/">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GoogleCloudPlatform/gcloud-python/issues">Issues</a></li>
<li class="toctree-l1"><a class="reference external" href="http://stackoverflow.com/questions/tagged/gcloud-python">Stack Overflow</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.python.org/pypi/gcloud">PyPI</a></li>
</ul>

      </nav><!-- end of .side-nav -->
    </article><!-- end of .main -->

    <script src="../../../../_static/js/vendor/jquery-1.10.2.min.js"></script>
    <script src="../../../../_static/js/plugins.js"></script>
    <script src="../../../../_static/js/main.js"></script>
  
  </body>
</html>